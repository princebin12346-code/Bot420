const moment = require("moment-timezone");

module.exports.config = {
  name: "autohadis12",
  version: "1.0",
  author: "Mohammad Akash | ChatGPT Edition",
  role: 0,
  description: "à¦ªà§à¦°à¦¤à¦¿ à¦˜à¦£à§à¦Ÿà¦¾à§Ÿ à§§à§¨ à¦¹à¦¾à¦¦à¦¿à¦¸ à¦˜à§à¦°à¦¿à§Ÿà§‡ à¦ªà¦¾à¦ à¦¾à¦¬à§‡ (à§§à§¨ à¦˜à¦£à§à¦Ÿà¦¾à§Ÿ à§§à§¨ à¦¹à¦¾à¦¦à¦¿à¦¸)",
  category: "AutoTime"
};

module.exports.onLoad = async function ({ api }) {

  setTimeout(() => {

    // â­ à¦®à§‹à¦Ÿ à§§à§¨ à¦Ÿà¦¿ à¦¹à¦¾à¦¦à¦¿à¦¸ â€“ à¦ªà§à¦°à¦¤à¦¿ à¦˜à¦£à§à¦Ÿà¦¾à§Ÿ à§§à¦Ÿà¦¿ à¦•à¦°à§‡
    const hadithList = [
      "â à¦¤à§‹à¦®à¦¾à¦¦à§‡à¦° à¦®à¦§à§à¦¯à§‡ à¦¸à¦°à§à¦¬à§‹à¦¤à§à¦¤à¦® à¦¸à§‡à¦‡ à¦¬à§à¦¯à¦•à§à¦¤à¦¿, à¦¯à¦¾à¦° à¦šà¦°à¦¿à¦¤à§à¦° à¦¸à¦°à§à¦¬à§‹à¦¤à§à¦¤à¦®à¥¤ âž â€” à¦¸à¦¹à¦¿à¦¹ à¦¬à§à¦–à¦¾à¦°à¦¿",
      "â à¦®à¦¾à¦¨à§à¦·à¦•à§‡ à¦–à¦¾à¦“à§Ÿà¦¾à¦¨à§‹ à¦à¦¬à¦‚ à¦¸à¦¾à¦²à¦¾à¦® à¦›à§œà¦¿à§Ÿà§‡ à¦¦à¦¾à¦“à¥¤ âž â€” à¦¤à¦¿à¦°à¦®à¦¿à¦œà¦¿",
      "â à¦ªà¦°à¦¿à¦ªà§‚à¦°à§à¦£ à¦®à§à¦®à¦¿à¦¨ à¦¸à§‡-à¦‡, à¦¯à¦¾à¦° à¦†à¦šà¦°à¦£ à¦‰à¦¤à§à¦¤à¦®à¥¤ âž â€” à¦†à¦¬à§ à¦¦à¦¾à¦‰à¦¦",
      "â à¦¯à§‡ à¦†à¦²à§à¦²à¦¾à¦¹à¦° à¦œà¦¨à§à¦¯ à¦¨à¦®à§à¦° à¦¹à§Ÿ, à¦†à¦²à§à¦²à¦¾à¦¹ à¦¤à¦¾à¦•à§‡ à¦®à¦°à§à¦¯à¦¾à¦¦à¦¾ à¦¦à¦¾à¦¨ à¦•à¦°à§‡à¦¨à¥¤ âž â€” à¦®à§à¦¸à¦²à¦¿à¦®",
      "â à¦¦à§à¦¨à¦¿à§Ÿà¦¾ à¦®à§à¦®à¦¿à¦¨à§‡à¦° à¦œà¦¨à§à¦¯ à¦•à¦¾à¦°à¦¾à¦—à¦¾à¦° à¦à¦¬à¦‚ à¦•à¦¾à¦«à§‡à¦°à§‡à¦° à¦œà¦¨à§à¦¯ à¦œà¦¾à¦¨à§à¦¨à¦¾à¦¤à¥¤ âž â€” à¦®à§à¦¸à¦²à¦¿à¦®",
      "â à¦…à¦²à§à¦ª à¦¹à¦¾à¦¸à§‹, à¦•à¦¾à¦°à¦£ à¦¬à§‡à¦¶à¦¿ à¦¹à¦¾à¦¸à¦¿ à¦¹à§ƒà¦¦à§Ÿà¦•à§‡ à¦®à§‡à¦°à§‡ à¦«à§‡à¦²à§‡à¥¤ âž â€” à¦‡à¦¬à¦¨ à¦®à¦¾à¦œà¦¾à¦¹",
      "â à¦¦à§Ÿà¦¾à¦²à§à¦¦à§‡à¦° à¦ªà§à¦°à¦¤à¦¿ à¦°à¦¹à¦®à¦¾à¦¨ à¦¦à§Ÿà¦¾ à¦•à¦°à§‡à¦¨à¥¤ âž â€” à¦¤à¦¿à¦°à¦®à¦¿à¦œà¦¿",
      "â à¦‰à¦¤à§à¦¤à¦® à¦®à¦¾à¦¨à§à¦· à¦¸à§‡à¦‡, à¦¯à§‡ à¦®à¦¾à¦¨à§à¦·à§‡à¦° à¦‰à¦ªà¦•à¦¾à¦° à¦•à¦°à§‡à¥¤ âž â€” à¦¦à¦¾à¦°à¦¾à¦•à§à¦¤à¦¨à§€",
      "â à¦œà§à¦žà¦¾à¦¨ à¦…à¦°à§à¦œà¦¨ à¦•à¦°à¦¾ à¦ªà§à¦°à¦¤à§à¦¯à§‡à¦• à¦®à§à¦¸à¦²à¦¿à¦®à§‡à¦° à¦“à¦ªà¦° à¦«à¦°à¦œà¥¤ âž â€” à¦‡à¦¬à¦¨ à¦®à¦¾à¦œà¦¾à¦¹",
      "â à¦¤à§‹à¦®à¦¾à¦¦à§‡à¦° à¦•à§‡à¦‰ à¦¤à¦¾à¦° à¦­à¦¾à¦‡à§Ÿà§‡à¦° à¦œà¦¨à§à¦¯ à¦¸à§‡ à¦œà¦¿à¦¨à¦¿à¦¸à¦‡ à¦•à¦¾à¦®à¦¨à¦¾ à¦•à¦°à§à¦• à¦¯à¦¾ à¦¨à¦¿à¦œà§‡à¦° à¦œà¦¨à§à¦¯ à¦•à¦°à§‡à¥¤ âž â€” à¦¬à§à¦–à¦¾à¦°à¦¿",
      "â à¦¦à§‹à§Ÿà¦¾ à¦®à§à¦®à¦¿à¦¨à§‡à¦° à¦…à¦¸à§à¦¤à§à¦°à¥¤ âž â€” à¦¹à¦¾à¦•à¦¿à¦®",
      "â à¦¯à§‡ à¦†à¦²à§à¦²à¦¾à¦¹à¦° à¦‰à¦ªà¦° à¦­à¦°à¦¸à¦¾ à¦•à¦°à§‡, à¦†à¦²à§à¦²à¦¾à¦¹ à¦¤à¦¾à¦° à¦œà¦¨à§à¦¯ à¦¯à¦¥à§‡à¦·à§à¦Ÿà¥¤ âž â€” à¦•à§à¦°à¦†à¦¨ à§¬à§«:à§©"
    ];

    let index = 0; // à¦à¦•à§‡ à¦à¦•à§‡ à§§à§¨à¦Ÿà¦¿ à¦¹à¦¾à¦¦à¦¿à¦¸ à¦˜à§à¦°à¦¬à§‡

    console.log("â³ Auto Hadith 12-hour system activated...");

    const sendHadith = async () => {
      const now = moment().tz("Asia/Dhaka").format("mm:ss");
      if (now !== "00:00") return;  // à¦ªà§à¦°à¦¤à¦¿ à¦˜à¦£à§à¦Ÿà¦¾à¦° à¦¶à§à¦°à§à¦¤à§‡à¦‡ à¦ªà¦¾à¦ à¦¾à¦¬à§‡

      // à¦¸à¦®à¦¯à¦¼, à¦¤à¦¾à¦°à¦¿à¦–
      const time = moment().tz("Asia/Dhaka").format("hh:mm A");
      const date = moment().tz("Asia/Dhaka").format("DD-MM-YYYY");

      const hour = parseInt(moment().tz("Asia/Dhaka").format("HH"));
      let period = "";

      if (hour >= 4 && hour < 12) period = "à¦¸à¦•à¦¾à¦²";
      else if (hour >= 12 && hour < 17) period = "à¦¦à§à¦ªà§à¦°";
      else if (hour >= 17 && hour < 20) period = "à¦¬à¦¿à¦•à§‡à¦²";
      else if (hour >= 20 && hour < 24) period = "à¦°à¦¾à¦¤";
      else period = "à¦­à§‹à¦°";

      // â­ à¦¬à¦°à§à¦¤à¦®à¦¾à¦¨ à¦¹à¦¾à¦¦à¦¿à¦¸
      const currentHadith = hadithList[index];
      index = (index + 1) % hadithList.length;  // à§§à§¨ à¦Ÿà¦¿ à¦¹à¦¾à¦¦à¦¿à¦¸ à¦ªà¦°à§‡ à¦†à¦¬à¦¾à¦° à§§à¦® à¦¹à¦¾à¦¦à¦¿à¦¸

      // ðŸ’Ž à¦¸à§à¦¨à§à¦¦à¦° à¦¡à¦¿à¦œà¦¾à¦‡à¦¨ à¦•à¦°à¦¾ à¦®à§‡à¦¸à§‡à¦œ
      const message =
`â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
 ðŸ•’ à¦¸à¦®à§Ÿ: ${period} ${time}
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ðŸ“– à¦¹à¦¾à¦¦à¦¿à¦¸ à¦†à¦®à¦² à¦•à¦°à¦¬à§‡à¦¨  
${currentHadith}

ðŸ“… à¦¤à¦¾à¦°à¦¿à¦–: ${date}
ðŸ•‹à¦†à¦¤-à¦¤à¦¾à¦•à§à¦¬à¦“à§Ÿà¦¾ à¦«à¦¾à¦‰à¦¨à§à¦¡à§‡à¦¶à¦¨ðŸ•‹
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”`;

      try {
        const threads = await api.getThreadList(100, null, ["INBOX"]);
        const groups = threads.filter(t => t.isGroup);

        console.log(`ðŸ“¤ Sending hadith to ${groups.length} groups...`);

        for (const g of groups) {
          await api.sendMessage(message, g.threadID);
        }

      } catch (err) {
        console.log("âŒ Error:", err);
      }
    };

    setInterval(sendHadith, 1000);
  }, 5000);
};

module.exports.onStart = () => {};
